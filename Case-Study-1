 1. What is the total amount each customer spent at the restaurant?
 
 Ans-1
select s.customer_id, sum(m.price)
from dannys_diner.sales s
left join dannys_diner.menu m
on s.product_id = m.product_id
group by s.customer_id

-- 2. How many days has each customer visited the restaurant?
select s.customer_id,count(distinct order_date) as ttoal_days
from dannys_diner.sales s
group by 1


-- 3. What was the first item from the menu purchased by each customer?
with cte as(select *,
dense_rank() over(partition by customer_id order by order_date) as rnk
from dannys_diner.sales s
left join dannys_diner.menu m
on s.product_id = m.product_id)

select customer_id, product_name
from cte


-- 4. What is the most purchased item on the menu and how many times was it purchased by all customers?
	SELECT 
    product_name,
   count(1)
   FROM dannys_diner.sales AS s
	JOIN dannys_diner.menu AS m
		ON s.product_id = m.product_id
        group by 1
        order by count(1) desc
